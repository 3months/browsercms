<% @page_title = "Administration / User Browser" %>
<h2><%= @page_title %></h2>
<p>The User Browser allows you to browse all the users in the system. <br />
<%= link_to "Add a User", :controller=>"users", :action=> "new" %>
</p>

<% form_tag(cms_path(:users), :method => :get ) do %>

<table>
    <tr>
        <td>Search by Username, Email or Name:
            <%= text_field_tag "key_word", params[:key_word] %>
        </td>
        <td>
            Display:
						<%= select_per_page %>
        </td>
    </tr>
    <tr>
        <td>Filter by:
           <%= group_filter %>
            <br>
            <%= check_box_tag "show_expired", "yes", params[:show_expired] %>Show disabled users?
        </td>
        <td align="right">
            <input type="submit" alt="Search"/>
        </td>
    </tr>
</table>
<% end %>
<br />
<%= page_entries_info(@users) %>
<table class="data" width="100%">
    <tr>
        <th>General Information</th>
        <th>Groups</th>
        <th>Actions</th>
    </tr>
    <% @users.each do |user|%>
    <tr>
        <td>
            <span class="username"><%= user.login  %></span><br/>
            Full Name: <%= "#{user.first_name} #{user.last_name}" %> <br/>
            Email: <%= user.email %> <br/>
            Expires: <%= user.expires_at ? format_date(user.expires_at) : "Never" %>
        </td>
        <td>
            <% user.groups.all(:order => "groups.name").each do |g| %>
			- <%= g.name %><br/>
			<% end %>
        </td>
        <td>
            <%= link_to "Edit", :controller=>"users", :action=> "edit", :id => user.id %><br/>
            <%= link_to "Change Password", :controller=>"users", :action=> "change_password", :id => user.id %> <br/>
            <%= link_to "Disable User", :controller=>"users", :action=> "disable", :id => user.id unless user.expires_at %>
            <%= link_to "Enable User", :controller=>"users", :action=> "enable", :id => user.id if user.expires_at %> <br/>
        </td>
    </tr>
    <% end %>
</table>

<%= will_paginate(@users) %>