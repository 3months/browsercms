<% @page_title = "Administration / Group Browser" %>
<% @toolbar_title = "List Groups" %>

<table id="blocks">
  <tr>
    <th>Group</th>
		<th>Permissions</th>
  </tr>
  <% section_count = Section.count %>
  <% Group.all(:order => "name").each do |g| %>
  <tr>
    <td><%= link_to h(g.name), cms_path(g, :edit) %></td>
    <td>
			<% g.permissions.each do |p| %>
			- <%= p.full_name %> <br />
			<% end %>
			- <%= g.cms_access? ? "Edit" : "View" %>
			<%= g.sections.count >= section_count ? "All Sections" : "#{g.sections.count} of #{section_count} Sections" %>
		</td>
  </tr>
  <% end %>
</table>

<fieldset class="form">
  <legend>Add New Group</legend>
  <% @group ||= Group.new %>
  <% form_for @group, :url => cms_path(:groups, :create) do |f| %>
	<%= hidden_field_tag "on_fail_action", "index" %>
	<%= render :partial => 'form', :locals => {:f => f} %>
  <% end %>
</fieldset>
