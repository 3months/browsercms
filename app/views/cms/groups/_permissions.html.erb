<table id="permissions">
  <tr>
    <th colspan="3">
      What kind of tasks should group members be allowed to do?
      <%= hidden_field_tag "group[permission_ids][]", "" %>  
    </th>
	</tr>	
	<tr>
	  <td>&nbsp;</td>
		<td>Permission</td>
		<td>Description</td>
	</tr>
	<% Permission.all(:order => "name").each do |p|%><tr>
		<td><%= check_box_tag "group[permission_ids][]", p.id, @group.permissions.include?(p), :id => "permission_ids_#{p.id}", :class => "permission_ids" %></td>
		<td><%=h p.full_name %></td>
		<td><%=h p.description %></td>
	</tr><% end %>
	<tr>
		<td colspan="3">
		  <%= link_to_check_all 'input.permission_ids' %>
		  <%= link_to_uncheck_all 'input.permission_ids' %>
		</td>
	</tr>
</table>

<script>
document.observe('dom:loaded', function() {
  <% unless @group.group_type.cms_access? %>$('permissions').hide();<% end -%>
  $('group_group_type_id').observe('change', function() {
    if ($F('group_group_type_id') != '<%= GroupType.cms_accessible %>') $('permissions').hide();
    else $('permissions').show();
  });
});
</script>