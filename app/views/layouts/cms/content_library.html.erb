  <%= render :partial => 'layouts/cms/head' %>
  <body>
    <div id="wrapper">
      <div id="page">
        <%= cms_toolbar(:content_library) %>
	
        <div id="main">
          <div id="functions">
            <%= link_to span_tag("VIEW"), "#", :id => "view_button", :class => "button disabled" %>
            <%= link_to span_tag("EDIT"), "#", :id => "edit_button", :class => "button disabled" %>
            <%= link_to span_tag("ADD A #{@content_type.display_name.upcase}"), cms_path("/blocks/#{@content_type.content_block_type.pluralize}", :new), :id => "add_button", :class => "button" %>
            <%= link_to span_tag("DELETE"), "#", :id => "delete_button", :class => "button disabled", :onclick => "return confirm('Are you sure you want to delete this record?')" %>
            <br clear="all" />
          </div>
          <div id="cms_content_library">
            <div id="menu">
              <div class="pad">
                
                <h3>Search</h3>
                <div class="searchbox">
                  <% form_tag '', :method => :get do -%>
                  <%= text_field_tag "search[term]", (params[:search] ? params[:search][:term] : nil) %>
                  <% if @content_type.name == "HtmlBlock" -%>
                  <p><%= check_box_tag "search[include_body]", true, (params[:search] ? params[:search][:include_body] : false) %> Include body?</p>
                  <% end -%>
                  <% if %w[FileBlock ImageBlock].include?(@content_type.name) %>
                  <p><%= select_tag 'section_id', searchable_sections(params[:section_id]) %></p>
                  <% end -%>
                  <%= submit_tag "Search" %>
                  <% end -%>
                </div>
                
              </div>
              <div class="pad">
                
                <%= yield :sidebar %>
                <h3 id="content_types">Content Types</h3>
                <ul><% ContentTypeGroup.all(:order => "content_type_groups.id").each do |g| %>
          	  <li<%= ' class="open"' if g == @content_type.content_type_group %>>
          	    <% if g.content_types.blank? %>
          	    <%= link_to h(g.name), "#" %>          				  
          	    <% else %>
          	    <%= link_to h(g.name), cms_path("/blocks/#{g.content_types.first.content_block_type}") %>          				  
          	    <ul>
          	      <% g.content_types.each do |t| %>
          	      <li<%= ' class="on"' if t == @content_type %>><%= link_to h(t.display_name), cms_path("/blocks/#{t.content_block_type}") %></li>
          	      <% end -%>
          	    </ul><% end -%>
          	  </li>
          	  <% end %></ul>
              </div>
            </div>
            
            <div id="contentwrap">
              <div id="content">
                <div class="pad">
                  <%= yield %>
                </div>
              </div>
            </div>
            <br clear="all" />
          </div>
          <%= render :partial => 'layouts/cms/footer' %>
        </div>
      </div>
    </div>
  </body>
</html>
